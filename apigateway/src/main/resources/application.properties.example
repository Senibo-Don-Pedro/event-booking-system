spring.application.name=apigateway
server.port=8080

# --- Service URLs ---
user.service.url=http://localhost:8084
event.service.url=http://localhost:8081
booking.service.url=http://localhost:8083

# --- JWT Configuration ---
spring.app.jwtSecret=generate_yours
spring.app.jwtExpirationMs=86400000

# --- Routes Configuration ---

# 1. User Service Route
spring.cloud.gateway.server.webflux.routes[0].id=user-service
spring.cloud.gateway.server.webflux.routes[0].uri=${user.service.url}
spring.cloud.gateway.server.webflux.routes[0].predicates[0]=Path=/api/auth/**, /api/users/**
spring.cloud.gateway.server.webflux.routes[0].filters[0]=AuthenticationFilter

# 2. Event Service Route
spring.cloud.gateway.server.webflux.routes[1].id=event-service
spring.cloud.gateway.server.webflux.routes[1].uri=${event.service.url}
spring.cloud.gateway.server.webflux.routes[1].predicates[0]=Path=/api/events/**
spring.cloud.gateway.server.webflux.routes[1].filters[0]=AuthenticationFilter

# 3. Booking Service Route
spring.cloud.gateway.server.webflux.routes[2].id=booking-service
spring.cloud.gateway.server.webflux.routes[2].uri=${booking.service.url}
spring.cloud.gateway.server.webflux.routes[2].predicates[0]=Path=/api/bookings/**
spring.cloud.gateway.server.webflux.routes[2].filters[0]=AuthenticationFilter

# --- Swagger Internal Routes ---

# 4. User Service Docs
spring.cloud.gateway.server.webflux.routes[3].id=user-service-docs
spring.cloud.gateway.server.webflux.routes[3].uri=${user.service.url}
spring.cloud.gateway.server.webflux.routes[3].predicates[0]=Path=/v3/api-docs/user-service
spring.cloud.gateway.server.webflux.routes[3].filters[0]=RewritePath=/v3/api-docs/user-service,/v3/api-docs

# 5. Event Service Docs
spring.cloud.gateway.server.webflux.routes[4].id=event-service-docs
spring.cloud.gateway.server.webflux.routes[4].uri=${event.service.url}
spring.cloud.gateway.server.webflux.routes[4].predicates[0]=Path=/v3/api-docs/event-service
spring.cloud.gateway.server.webflux.routes[4].filters[0]=RewritePath=/v3/api-docs/event-service,/v3/api-docs

# 6. Booking Service Docs
spring.cloud.gateway.server.webflux.routes[5].id=booking-service-docs
spring.cloud.gateway.server.webflux.routes[5].uri=${booking.service.url}
spring.cloud.gateway.server.webflux.routes[5].predicates[0]=Path=/v3/api-docs/booking-service
spring.cloud.gateway.server.webflux.routes[5].filters[0]=RewritePath=/v3/api-docs/booking-service,/v3/api-docs

spring.cloud.config.enabled=false

# --- Logging ---
logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.reactor.netty.http.client=DEBUG

# --- Global CORS Configuration ---
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowedOrigins=*
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowedMethods=GET,POST,PUT,DELETE,OPTIONS
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowedHeaders=*
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowCredentials=false

# --- Swagger Aggregation Config ---
# IMPORTANT: Change the gateway's own API docs path to avoid conflict
springdoc.api-docs.path=/v3/api-docs/gateway
springdoc.swagger-ui.path=/swagger-ui.html

# Configure the aggregated service URLs
springdoc.swagger-ui.urls[0].name=User Service
springdoc.swagger-ui.urls[0].url=/v3/api-docs/user-service

springdoc.swagger-ui.urls[1].name=Event Service
springdoc.swagger-ui.urls[1].url=/v3/api-docs/event-service

springdoc.swagger-ui.urls[2].name=Booking Service
springdoc.swagger-ui.urls[2].url=/v3/api-docs/booking-service